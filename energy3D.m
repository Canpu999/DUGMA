function F=energy3D(X)
   global A
   t1=X(1);
   t2=X(2);
   t3=X(3);
   r11= X(4);
   r12= X(5);
   r13=X(6);
   r21=X(7);
   r22=X(8);
   r23=X(9);
   r31=X(10);
   r32=X(11);
   r33=X(12);
   B= [1, r11*r11*r11*r11, r21*r21*r21*r21, r12*r12*r12*r12, r31*r31*r31*r31, r22*r22*r22*r22, r13*r13*r13*r13, r32*r32*r32*r32, r23*r23*r23*r23, r33*r33*r33*r33, r11*r11, r12*r12, r13*r13, r21*r21, r31*r31, r22*r22, r23*r23, r32*r32, r33*r33, r11, r12, r13, r21, r22, r23, r31, r32, r33, r11*r11*r12*r12, r11*r11*r13*r13, r11*r11*r21*r21, r12*r12*r13*r13, r11*r11*r31*r31, r21*r21*r22*r22, r21*r21*r23*r23, r12*r12*r22*r22, r21*r21*r31*r31, r12*r12*r32*r32, r22*r22*r23*r23, r13*r13*r23*r23, r31*r31*r32*r32, r31*r31*r33*r33, r22*r22*r32*r32, r13*r13*r33*r33, r32*r32*r33*r33, r23*r23*r33*r33, r11*r11*r11, r21*r21*r21, r12*r12*r12, r31*r31*r31, r22*r22*r22, r13*r13*r13, r32*r32*r32, r23*r23*r23, r33*r33*r33, r11*r12, r11*r13, r11*r21, r12*r22, r12*r13, r13*r23, r11*r31, r21*r22, r21*r23, r12*r32, r13*r33, r22*r23, r21*r31, r31*r32, r22*r32, r31*r33, r23*r33, r32*r33, r11*r11*r11*r12, r11*r12*r12*r12, r11*r11*r11*r13, r11*r13*r13*r13, r12*r12*r12*r13, r12*r13*r13*r13, r21*r21*r21*r22, r21*r22*r22*r22, r21*r21*r21*r23, r21*r23*r23*r23, r22*r22*r22*r23, r22*r23*r23*r23, r31*r31*r31*r32, r31*r32*r32*r32, r31*r31*r31*r33, r31*r33*r33*r33, r32*r32*r32*r33, r32*r33*r33*r33, r11*r11*r22*r22, r12*r12*r21*r21, r11*r11*r23*r23, r13*r13*r21*r21, r11*r11*r32*r32, r12*r12*r31*r31, r11*r11*r33*r33, r13*r13*r31*r31, r12*r12*r23*r23, r13*r13*r22*r22, r21*r21*r32*r32, r22*r22*r31*r31, r21*r21*r33*r33, r23*r23*r31*r31, r12*r12*r33*r33, r13*r13*r32*r32, r22*r22*r33*r33, r23*r23*r32*r32, r11*r12*r13*r13, r11*r12*r12*r13, r11*r12*r21*r21, r11*r12*r22*r22, r11*r13*r21*r21, r11*r11*r12*r13, r11*r13*r23*r23, r11*r12*r31*r31, r11*r11*r21*r22, r11*r12*r32*r32, r12*r12*r21*r22, r11*r13*r31*r31, r11*r11*r21*r23, r12*r13*r22*r22, r11*r13*r33*r33, r13*r13*r21*r23, r12*r13*r23*r23, r21*r22*r23*r23, r21*r22*r22*r23, r12*r13*r32*r32, r12*r12*r22*r23, r12*r13*r33*r33, r13*r13*r22*r23, r21*r22*r31*r31, r11*r11*r31*r32, r21*r22*r32*r32, r12*r12*r31*r32, r21*r23*r31*r31, r11*r11*r31*r33, r21*r21*r22*r23, r21*r23*r33*r33, r13*r13*r31*r33, r21*r21*r31*r32, r22*r22*r31*r32, r21*r21*r31*r33, r22*r23*r32*r32, r12*r12*r32*r33, r23*r23*r31*r33, r22*r23*r33*r33, r13*r13*r32*r33, r31*r32*r33*r33, r31*r32*r32*r33, r22*r22*r32*r33, r23*r23*r32*r33, r31*r31*r32*r33, r11*r22, r12*r21, r11*r23, r13*r21, r12*r23, r13*r22, r11*r32, r12*r31, r11*r33, r13*r31, r12*r33, r13*r32, r21*r32, r22*r31, r21*r33, r23*r31, r22*r33, r23*r32, r11*r11*r12, r11*r12*r12, r11*r11*r13, r11*r13*r13, r11*r21*r21, r11*r11*r21, r12*r21*r21, r11*r11*r22, r11*r22*r22, r12*r12*r21, r13*r21*r21, r11*r11*r23, r11*r23*r23, r12*r12*r13, r13*r13*r21, r12*r13*r13, r11*r31*r31, r11*r11*r31, r12*r31*r31, r21*r21*r22, r11*r32*r32, r11*r11*r32, r21*r22*r22, r13*r31*r31, r12*r22*r22, r21*r21*r23, r12*r12*r31, r12*r12*r22, r11*r11*r33, r11*r33*r33, r13*r22*r22, r21*r23*r23, r12*r12*r23, r12*r23*r23, r13*r13*r31, r13*r13*r22, r21*r31*r31, r21*r21*r31, r22*r31*r31, r21*r21*r32, r21*r32*r32, r12*r32*r32, r22*r22*r31, r23*r31*r31, r21*r21*r33, r12*r12*r32, r13*r32*r32, r21*r33*r33, r22*r22*r23, r12*r33*r33, r23*r23*r31, r12*r12*r33, r22*r23*r23, r13*r23*r23, r13*r13*r32, r13*r13*r23, r31*r31*r32, r31*r32*r32, r22*r32*r32, r31*r31*r33, r22*r22*r32, r23*r32*r32, r31*r33*r33, r22*r22*r33, r22*r33*r33, r13*r33*r33, r23*r23*r32, r13*r13*r33, r32*r32*r33, r32*r33*r33, r23*r33*r33, r23*r23*r33, r12*r13*r21*r21, r11*r13*r22*r22, r11*r12*r23*r23, r12*r13*r31*r31, r11*r11*r22*r23, r11*r13*r32*r32, r12*r12*r21*r23, r11*r12*r33*r33, r13*r13*r21*r22, r22*r23*r31*r31, r11*r11*r32*r33, r21*r23*r32*r32, r12*r12*r31*r33, r21*r22*r33*r33, r13*r13*r31*r32, r21*r21*r32*r33, r22*r22*r31*r33, r23*r23*r31*r32, r11*r12*r21*r22, r11*r13*r21*r23, r11*r12*r22*r23, r12*r13*r21*r22, r11*r13*r22*r23, r12*r13*r21*r23, r11*r12*r21*r23, r11*r13*r21*r22, r12*r13*r22*r23, r11*r12*r31*r32, r11*r13*r31*r33, r11*r12*r32*r33, r12*r13*r31*r32, r11*r13*r32*r33, r12*r13*r31*r33, r11*r12*r31*r33, r11*r13*r31*r32, r12*r13*r32*r33, r21*r22*r31*r32, r21*r23*r31*r33, r21*r22*r32*r33, r22*r23*r31*r32, r21*r23*r32*r33, r22*r23*r31*r33, r21*r22*r31*r33, r21*r23*r31*r32, r22*r23*r32*r33, r11*r12*r13, r11*r12*r21, r11*r13*r21, r11*r12*r22, r11*r13*r22, r12*r13*r21, r11*r12*r23, r11*r13*r23, r11*r21*r22, r11*r12*r31, r11*r21*r23, r12*r21*r22, r11*r13*r31, r11*r12*r32, r11*r22*r23, r12*r21*r23, r13*r21*r22, r11*r13*r32, r12*r13*r31, r11*r12*r33, r13*r21*r23, r12*r13*r22, r11*r13*r33, r12*r13*r23, r21*r22*r23, r12*r22*r23, r12*r13*r32, r13*r22*r23, r12*r13*r33, r11*r31*r32, r21*r22*r31, r11*r31*r33, r12*r31*r32, r21*r23*r31, r21*r22*r32, r11*r32*r33, r12*r31*r33, r13*r31*r32, r21*r23*r32, r22*r23*r31, r21*r22*r33, r13*r31*r33, r21*r23*r33, r21*r31*r32, r21*r31*r33, r22*r31*r32, r21*r32*r33, r22*r31*r33, r23*r31*r32, r12*r32*r33, r23*r31*r33, r22*r23*r32, r13*r32*r33, r22*r23*r33, r31*r32*r33, r22*r32*r33, r23*r32*r33, t1*t1, t2*t2, t3*t3, t1, t2, t3, t1*t2, t1*t3, t2*t3, r11*r11*t1*t1, r21*r21*t2*t2, r12*r12*t1*t1, r31*r31*t3*t3, r22*r22*t2*t2, r13*r13*t1*t1, r32*r32*t3*t3, r23*r23*t2*t2, r33*r33*t3*t3, r11*t1, r12*t1, r11*t2, r13*t1, r12*t2, r11*t3, r13*t2, r12*t3, r13*t3, r21*t1, r22*t1, r23*t1, r31*t1, r21*t2, r32*t1, r22*t2, r21*t3, r33*t1, r23*t2, r22*t3, r23*t3, r31*t2, r32*t2, r33*t2, r31*t3, r32*t3, r33*t3, r11*r11*r11*t1, r21*r21*r21*t2, r12*r12*r12*t1, r31*r31*r31*t3, r22*r22*r22*t2, r13*r13*r13*t1, r32*r32*r32*t3, r23*r23*r23*t2, r33*r33*r33*t3, r11*r11*t1, r21*r21*t2, r12*r12*t1, r31*r31*t3, r22*r22*t2, r13*r13*t1, r32*r32*t3, r23*r23*t2, r33*r33*t3, r11*r12*t1*t1, r11*r13*t1*t1, r12*r13*t1*t1, r21*r22*t2*t2, r21*r23*t2*t2, r22*r23*t2*t2, r31*r32*t3*t3, r31*r33*t3*t3, r32*r33*t3*t3, r11*r12*t1, r11*r13*t1, r11*r21*t2, r11*r21*t1, r11*r22*t2, r12*r21*t2, r11*r22*t1, r12*r21*t1, r11*r23*t2, r13*r21*t2, r11*r23*t1, r13*r21*t1, r12*r13*t1, r11*r31*t3, r11*r31*t1, r11*r32*t3, r12*r31*t3, r21*r22*t2, r11*r32*t1, r12*r31*t1, r12*r22*t2, r12*r22*t1, r11*r33*t3, r13*r31*t3, r21*r23*t2, r11*r33*t1, r13*r31*t1, r12*r23*t2, r13*r22*t2, r12*r23*t1, r13*r22*t1, r21*r31*t3, r21*r31*t2, r21*r32*t3, r22*r31*t3, r21*r32*t2, r22*r31*t2, r12*r32*t3, r12*r32*t1, r21*r33*t3, r23*r31*t3, r21*r33*t2, r23*r31*t2, r12*r33*t3, r13*r32*t3, r22*r23*t2, r12*r33*t1, r13*r32*t1, r13*r23*t2, r13*r23*t1, r31*r32*t3, r22*r32*t3, r22*r32*t2, r31*r33*t3, r22*r33*t3, r23*r32*t3, r22*r33*t2, r23*r32*t2, r13*r33*t3, r13*r33*t1, r32*r33*t3, r23*r33*t3, r23*r33*t2, r11*r21*t1*t2, r11*r22*t1*t2, r12*r21*t1*t2, r11*r23*t1*t2, r13*r21*t1*t2, r11*r31*t1*t3, r11*r32*t1*t3, r12*r31*t1*t3, r12*r22*t1*t2, r11*r33*t1*t3, r13*r31*t1*t3, r12*r23*t1*t2, r13*r22*t1*t2, r21*r31*t2*t3, r21*r32*t2*t3, r22*r31*t2*t3, r12*r32*t1*t3, r21*r33*t2*t3, r23*r31*t2*t3, r12*r33*t1*t3, r13*r32*t1*t3, r13*r23*t1*t2, r22*r32*t2*t3, r22*r33*t2*t3, r23*r32*t2*t3, r13*r33*t1*t3, r23*r33*t2*t3, r11*r11*r12*t1, r11*r12*r12*t1, r11*r11*r13*t1, r11*r13*r13*t1, r11*r21*r21*t1, r11*r11*r21*t2, r12*r21*r21*t1, r11*r11*r22*t2, r11*r22*r22*t1, r12*r12*r21*t2, r13*r21*r21*t1, r11*r11*r23*t2, r11*r23*r23*t1, r12*r12*r13*t1, r13*r13*r21*t2, r12*r13*r13*t1, r11*r31*r31*t1, r11*r11*r31*t3, r12*r31*r31*t1, r21*r21*r22*t2, r11*r32*r32*t1, r11*r11*r32*t3, r21*r22*r22*t2, r13*r31*r31*t1, r12*r22*r22*t1, r21*r21*r23*t2, r12*r12*r31*t3, r12*r12*r22*t2, r11*r11*r33*t3, r11*r33*r33*t1, r13*r22*r22*t1, r21*r23*r23*t2, r12*r12*r23*t2, r12*r23*r23*t1, r13*r13*r31*t3, r13*r13*r22*t2, r21*r31*r31*t2, r21*r21*r31*t3, r22*r31*r31*t2, r21*r21*r32*t3, r21*r32*r32*t2, r12*r32*r32*t1, r22*r22*r31*t3, r23*r31*r31*t2, r21*r21*r33*t3, r12*r12*r32*t3, r13*r32*r32*t1, r21*r33*r33*t2, r22*r22*r23*t2, r12*r33*r33*t1, r23*r23*r31*t3, r12*r12*r33*t3, r22*r23*r23*t2, r13*r23*r23*t1, r13*r13*r32*t3, r13*r13*r23*t2, r31*r31*r32*t3, r31*r32*r32*t3, r22*r32*r32*t2, r31*r31*r33*t3, r22*r22*r32*t3, r23*r32*r32*t2, r31*r33*r33*t3, r22*r22*r33*t3, r22*r33*r33*t2, r13*r33*r33*t1, r23*r23*r32*t3, r13*r13*r33*t3, r32*r32*r33*t3, r32*r33*r33*t3, r23*r33*r33*t2, r23*r23*r33*t3, r11*r12*r13*t1, r11*r12*r21*t2, r11*r13*r21*t2, r11*r12*r22*t2, r11*r13*r22*t2, r12*r13*r21*t2, r11*r12*r23*t2, r11*r13*r23*t2, r11*r21*r22*t1, r11*r12*r31*t3, r11*r21*r23*t1, r12*r21*r22*t1, r11*r13*r31*t3, r11*r12*r32*t3, r11*r22*r23*t1, r12*r21*r23*t1, r13*r21*r22*t1, r11*r13*r32*t3, r12*r13*r31*t3, r11*r12*r33*t3, r13*r21*r23*t1, r12*r13*r22*t2, r11*r13*r33*t3, r12*r13*r23*t2, r21*r22*r23*t2, r12*r22*r23*t1, r12*r13*r32*t3, r13*r22*r23*t1, r12*r13*r33*t3, r11*r31*r32*t1, r21*r22*r31*t3, r11*r31*r33*t1, r12*r31*r32*t1, r21*r23*r31*t3, r21*r22*r32*t3, r11*r32*r33*t1, r12*r31*r33*t1, r13*r31*r32*t1, r21*r23*r32*t3, r22*r23*r31*t3, r21*r22*r33*t3, r13*r31*r33*t1, r21*r23*r33*t3, r21*r31*r32*t2, r21*r31*r33*t2, r22*r31*r32*t2, r21*r32*r33*t2, r22*r31*r33*t2, r23*r31*r32*t2, r12*r32*r33*t1, r23*r31*r33*t2, r22*r23*r32*t3, r13*r32*r33*t1, r22*r23*r33*t3, r31*r32*r33*t3, r22*r32*r33*t2, r23*r32*r33*t2];
   F=A*B';
end
